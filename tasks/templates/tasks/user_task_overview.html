{% extends 'base.html' %}
{% load static %}
{% block title %}
  Task Overview
{% endblock %}

{% block css %}
  <link rel="stylesheet" href="{% static 'css/tasks/user_task_overview.css' %}" />
{% endblock %}

{% block content %}
  <section class="container py-5">
    <header class="d-flex align-items-center justify-content-between mb-4">
      <h1 class="h2 mb-0">Task Overview</h1>
      {% if not perms.tasks.mark_done %}
        <a href="{% url 'add_task' %}" class="btn btn-primary" aria-label="Add Task">Add Task</a>
      {% endif %}
    </header>
    <section class="container py-5">
      <h2 class="h4 mb-3">Your Task Slots: <span>
        {% if tasks %}
          {{ tasks.count }}
        {% else %}
          0
        {% endif %}
        /
        {% if subscription.product_name == "Standard" %}
          7
        {% else %}
          10
        {% endif %}
      </span>
    </h2>

    </section>
    <!-- Open / Undone -->
    <section class="mb-5" aria-labelledby="open-tasks">
      <h2 id="open-tasks" class="h4 mb-3">Open Tasks</h2>
      {% if tasks_undone and tasks_undone.count > 0 %}
        <div class="row row-cols-1 row-cols-md-2 g-4">
          {% for task in tasks_undone %}
            <div class="col">
              {% include 'tasks/_task_card.html' with task=task %}
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info mb-0" role="alert">You have no current tasks.</div>
      {% endif %}
    </section>

    <!-- Done -->
    <section aria-labelledby="done-tasks">
      <h2 id="done-tasks" class="h4 mb-3">Done Tasks</h2>
      {% if tasks_done and tasks_done.count > 0 %}
        <div class="row row-cols-1 row-cols-md-2 g-4">
          {% for task in tasks_done %}
            <div class="col">
              {% include 'tasks/_task_card.html' with task=task %}
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-secondary mb-0" role="alert">No tasks completed yet.</div>
      {% endif %}
    </section>
  </section>
{% endblock %}
