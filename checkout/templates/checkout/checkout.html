{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}
  {% trans 'Checkout' %}
{% endblock %}
{% block css %}

{% endblock %}

{% block content %}
  <section class="container py-5">
    <header class="mb-4 d-flex align-items-center justify-content-between">
      <h1 class="h3 mb-0">{% trans 'Checkout' %}</h1>
    </header>

    {% if reward %}
      <section class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <div class="row g-3 align-items-center">

            {% if 'placeholder' in reward.image.url %}
              <img src="{% static 'images/placeholder/placeholder.webp' %}" class="card-img-top" alt="Reward Cup" />
            {% else %}
              <img src="{{ reward.image.url }}" class="card-img-top" alt="{{ reward.name }} image" />
            {% endif %}

            <div class="{% if reward.image %}
                
                col-9 col-sm-10

              {% else %}
                
                col-12

              {% endif %}">
              <div class="d-flex flex-wrap align-items-center gap-2">
                <span class="badge bg-primary-subtle text-primary text-uppercase fw-semibold">{% trans 'Reward' %}</span>
                <h2 class="h5 mb-0">{{ reward.name }}</h2>
              </div>

              <div class="mt-2 d-flex flex-wrap gap-3">
                {% if reward.cost %}
                  <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-stars" aria-hidden="true"></i>
                    <span class="fw-semibold">{% trans 'Point cost' %}:</span>
                    <span>{{ reward.cost }}</span> | <span class="text-body-secondary">{{ user_points.points }} {% trans 'available' %}</span>
                  </div>
                {% endif %}
              </div>

              {% if reward.description %}
                <p class="mb-0 mt-2 text-body-secondary">{{ reward.description }}</p>
              {% endif %}
            </div>
          </div>
        </div>
      </section>
    {% else %}
      <div class="alert alert-warning mb-4" role="alert">
        {% trans 'No reward selected. Please go back and choose a reward.' %}
      </div>
    {% endif %}

    <!-- Checkout-Formular -->
    <form method="post" novalidate class="card border-0 shadow-sm">
      <div class="card-body">
        {% csrf_token %}
        {{ form|crispy }}

        <div class="d-grid d-sm-flex gap-2 mt-2">
          <a href="javascript:history.back()" class="btn btn-outline-secondary"><i class="bi bi-arrow-left-short" aria-hidden="true"></i> {% trans 'Back' %}</a>
          <button type="submit" class="btn btn-primary ms-sm-auto"><i class="bi bi-check2-circle" aria-hidden="true"></i> {% trans 'Place Order' %}</button>
        </div>
      </div>
    </form>
  </section>
{% endblock %}
