{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}
  {% trans 'Checkout' %}
{% endblock %}
{% block css %}
{% endblock %}

{% block content %}
  <section class="container py-5">
    <!-- Seite: Titel -->
    <header class="mb-4 d-flex align-items-center justify-content-between">
      <h1 class="h3 mb-0">{% trans 'Checkout' %}</h1>
    </header>

    <!-- Zusammenfassung oben -->
    {% if reward %}
      <section class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <div class="row g-3 align-items-center">
            <!-- Bild (optional) -->
            {% if reward.image %}
              <div class="col-3 col-sm-2">
                <div class="ratio ratio-1x1">
                  <img src="{{ reward.image.url }}" alt="{{ reward.name }}" class="img-fluid rounded object-fit-cover" />
                </div>
              </div>
            {% endif %}

            <!-- Text-Infos -->
            <div class="{% if reward.image %}
                col-9 col-sm-10
              {% else %}
                col-12
              {% endif %}">
              <div class="d-flex flex-wrap align-items-center gap-2">
                <span class="badge bg-primary-subtle text-primary text-uppercase fw-semibold">{% trans 'Reward' %}</span>
                <h2 class="h5 mb-0">{{ reward.name }}</h2>
              </div>

              <div class="mt-2 d-flex flex-wrap gap-3">
                {% if reward.point_cost %}
                  <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-stars" aria-hidden="true"></i>
                    <span class="fw-semibold">{% trans 'Point cost' %}:</span>
                    <span>{{ reward.point_cost }}</span>
                  </div>
                {% endif %}

                {% if reward.price or reward.cost %}
                  <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-currency-euro" aria-hidden="true"></i>
                    <span class="fw-semibold">{% trans 'Price' %}:</span>
                    <span>{{ reward.price|default:reward.cost }}</span>
                  </div>
                {% endif %}
              </div>

              {% if reward.description %}
                <p class="mb-0 mt-2 text-body-secondary">{{ reward.description }}</p>
              {% endif %}
            </div>
          </div>
        </div>
      </section>
    {% else %}
      <div class="alert alert-warning mb-4" role="alert">
        {% trans 'No reward selected. Please go back and choose a reward.' %}
      </div>
    {% endif %}

    <!-- Checkout-Formular -->
    <form method="post" novalidate class="card border-0 shadow-sm">
      <div class="card-body">
        {% csrf_token %}
        {{ form|crispy }}

        <div class="d-grid d-sm-flex gap-2 mt-2">
          <a href="javascript:history.back()" class="btn btn-outline-secondary"><i class="bi bi-arrow-left-short" aria-hidden="true"></i> {% trans 'Back' %}</a>
          <button type="submit" class="btn btn-primary ms-sm-auto"><i class="bi bi-check2-circle" aria-hidden="true"></i> {% trans 'Place Order' %}</button>
        </div>
      </div>
    </form>
  </section>
{% endblock %}
